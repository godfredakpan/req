{"ast":null,"code":"import validate from '../validate/index.js';\nimport { findRules, updateRules } from './01-generate/index.js';\nimport { trimPairs, trimRules } from './02-trim/index.js';\nconst learn = function (pairs) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  pairs = validate(pairs, opts);\n  let rules = findRules(pairs);\n  let pairsLeft = pairs;\n  let pairsDone = [];\n  let chosen = [];\n\n  // pick our top rule\n  while (pairsLeft.length > 0 && rules.length > 0) {\n    let rule = rules.pop();\n    chosen.push([rule.from, rule.to]);\n\n    // remove now-covered pairs\n    let res = trimPairs(pairsLeft, rule);\n    pairsLeft = res.remain;\n    pairsDone = pairsDone.concat(res.done);\n\n    // remove now-unsafe rules\n    rules = trimRules(rules, pairsDone);\n    // re-rank our rules\n    rules = updateRules(rules, pairsLeft, opts);\n\n    // logging\n    if (opts.debug) {\n      console.log(`\\n${rule.from} -> ${rule.to || \"''\"}`);\n      console.log(`    \\x1b[32m +${res.done.length.toLocaleString()} pairs\\x1b[0m`);\n      console.log('   ', pairsLeft.length, 'remaining');\n      console.log('   ', rules.length, 'rules left');\n    }\n  }\n\n  // turn em upside-down\n  chosen = chosen.reverse();\n\n  // remaining pairs are exceptions\n  let exceptions = pairsLeft.reduce((h, a) => {\n    h[a[0]] = a[1];\n    return h;\n  }, {});\n  return {\n    rules: chosen,\n    exceptions\n  };\n};\nexport default learn;","map":{"version":3,"names":["validate","findRules","updateRules","trimPairs","trimRules","learn","pairs","opts","rules","pairsLeft","pairsDone","chosen","length","rule","pop","push","from","to","res","remain","concat","done","debug","console","log","toLocaleString","reverse","exceptions","reduce","h","a"],"sources":["/Users/godfredakpan/Documents/signature_generator/signature_generator/node_modules/suffix-thumb/src/learn/learn.js"],"sourcesContent":["import validate from '../validate/index.js'\nimport { findRules, updateRules } from './01-generate/index.js'\nimport { trimPairs, trimRules } from './02-trim/index.js'\n\nconst learn = function (pairs, opts = {}) {\n  pairs = validate(pairs, opts)\n  let rules = findRules(pairs)\n  let pairsLeft = pairs\n  let pairsDone = []\n  let chosen = []\n\n  // pick our top rule\n  while (pairsLeft.length > 0 && rules.length > 0) {\n    let rule = rules.pop()\n    chosen.push([rule.from, rule.to])\n\n    // remove now-covered pairs\n    let res = trimPairs(pairsLeft, rule)\n    pairsLeft = res.remain\n    pairsDone = pairsDone.concat(res.done)\n\n    // remove now-unsafe rules\n    rules = trimRules(rules, pairsDone)\n    // re-rank our rules\n    rules = updateRules(rules, pairsLeft, opts)\n\n    // logging\n    if (opts.debug) {\n      console.log(`\\n${rule.from} -> ${rule.to || \"''\"}`)\n      console.log(`    \\x1b[32m +${res.done.length.toLocaleString()} pairs\\x1b[0m`)\n      console.log('   ', pairsLeft.length, 'remaining')\n      console.log('   ', rules.length, 'rules left')\n    }\n  }\n\n  // turn em upside-down\n  chosen = chosen.reverse()\n\n  // remaining pairs are exceptions\n  let exceptions = pairsLeft.reduce((h, a) => {\n    h[a[0]] = a[1]\n    return h\n  }, {})\n\n  return {\n    rules: chosen,\n    exceptions\n  }\n}\nexport default learn"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,sBAAsB;AAC3C,SAASC,SAAS,EAAEC,WAAW,QAAQ,wBAAwB;AAC/D,SAASC,SAAS,EAAEC,SAAS,QAAQ,oBAAoB;AAEzD,MAAMC,KAAK,GAAG,UAAUC,KAAK,EAAa;EAAA,IAAXC,IAAI,uEAAG,CAAC,CAAC;EACtCD,KAAK,GAAGN,QAAQ,CAACM,KAAK,EAAEC,IAAI,CAAC;EAC7B,IAAIC,KAAK,GAAGP,SAAS,CAACK,KAAK,CAAC;EAC5B,IAAIG,SAAS,GAAGH,KAAK;EACrB,IAAII,SAAS,GAAG,EAAE;EAClB,IAAIC,MAAM,GAAG,EAAE;;EAEf;EACA,OAAOF,SAAS,CAACG,MAAM,GAAG,CAAC,IAAIJ,KAAK,CAACI,MAAM,GAAG,CAAC,EAAE;IAC/C,IAAIC,IAAI,GAAGL,KAAK,CAACM,GAAG,EAAE;IACtBH,MAAM,CAACI,IAAI,CAAC,CAACF,IAAI,CAACG,IAAI,EAAEH,IAAI,CAACI,EAAE,CAAC,CAAC;;IAEjC;IACA,IAAIC,GAAG,GAAGf,SAAS,CAACM,SAAS,EAAEI,IAAI,CAAC;IACpCJ,SAAS,GAAGS,GAAG,CAACC,MAAM;IACtBT,SAAS,GAAGA,SAAS,CAACU,MAAM,CAACF,GAAG,CAACG,IAAI,CAAC;;IAEtC;IACAb,KAAK,GAAGJ,SAAS,CAACI,KAAK,EAAEE,SAAS,CAAC;IACnC;IACAF,KAAK,GAAGN,WAAW,CAACM,KAAK,EAAEC,SAAS,EAAEF,IAAI,CAAC;;IAE3C;IACA,IAAIA,IAAI,CAACe,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAAE,KAAIX,IAAI,CAACG,IAAK,OAAMH,IAAI,CAACI,EAAE,IAAI,IAAK,EAAC,CAAC;MACnDM,OAAO,CAACC,GAAG,CAAE,iBAAgBN,GAAG,CAACG,IAAI,CAACT,MAAM,CAACa,cAAc,EAAG,eAAc,CAAC;MAC7EF,OAAO,CAACC,GAAG,CAAC,KAAK,EAAEf,SAAS,CAACG,MAAM,EAAE,WAAW,CAAC;MACjDW,OAAO,CAACC,GAAG,CAAC,KAAK,EAAEhB,KAAK,CAACI,MAAM,EAAE,YAAY,CAAC;IAChD;EACF;;EAEA;EACAD,MAAM,GAAGA,MAAM,CAACe,OAAO,EAAE;;EAEzB;EACA,IAAIC,UAAU,GAAGlB,SAAS,CAACmB,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;IAC1CD,CAAC,CAACC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;IACd,OAAOD,CAAC;EACV,CAAC,EAAE,CAAC,CAAC,CAAC;EAEN,OAAO;IACLrB,KAAK,EAAEG,MAAM;IACbgB;EACF,CAAC;AACH,CAAC;AACD,eAAetB,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}