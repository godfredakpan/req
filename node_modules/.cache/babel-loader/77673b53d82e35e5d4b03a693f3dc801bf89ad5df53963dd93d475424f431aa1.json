{"ast":null,"code":"const dollarStub = /\\$[0-9a-z]+/g;\nconst fns = {};\nconst titleCase = function (str) {\n  return str.replace(/\\w\\S*/g, txt => txt.charAt(0).toUpperCase() + txt.substring(1).toLowerCase());\n};\n\n// doc.replace('foo', (m)=>{})\nconst replaceByFn = function (main, fn) {\n  main.forEach(m => {\n    let out = fn(m);\n    m.replaceWith(out);\n  });\n  return main;\n};\n\n// support 'foo $0' replacements\nconst subDollarSign = function (input, main) {\n  if (typeof input !== 'string') {\n    return input;\n  }\n  let groups = main.groups();\n  input = input.replace(dollarStub, a => {\n    let num = a.replace(/\\$/, '');\n    if (groups.hasOwnProperty(num)) {\n      return groups[num].text();\n    }\n    return a;\n  });\n  return input;\n};\nfns.replaceWith = function (input) {\n  let keep = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let ptrs = this.fullPointer;\n  let main = this;\n  this.uncache();\n  if (typeof input === 'function') {\n    return replaceByFn(main, input);\n  }\n  // support 'foo $0' replacements\n  input = subDollarSign(input, main);\n  let original = this.update(ptrs);\n  // soften-up pointer\n  ptrs = ptrs.map(ptr => ptr.slice(0, 3));\n  // original.freeze()\n  let oldTags = (original.docs[0] || []).map(term => Array.from(term.tags));\n  // slide this in\n  if (typeof input === 'string') {\n    input = this.fromText(input).compute('id');\n  }\n  main.insertAfter(input);\n  // are we replacing part of a contraction?\n  if (original.has('@hasContraction') && main.contractions) {\n    let more = main.grow('@hasContraction+');\n    more.contractions().expand();\n  }\n  // delete the original terms\n  main.delete(original); //science.\n  // what should we return?\n  let m = main.toView(ptrs).compute(['index', 'lexicon']);\n  if (m.world.compute.preTagger) {\n    m.compute('preTagger');\n  }\n  // replace any old tags\n  if (keep.tags) {\n    m.terms().forEach((term, i) => {\n      term.tagSafe(oldTags[i]);\n    });\n  }\n  // try to co-erce case, too\n  if (keep.case && m.docs[0] && m.docs[0][0] && m.docs[0][0].index[1] === 0) {\n    m.docs[0][0].text = titleCase(m.docs[0][0].text);\n  }\n  // console.log(input.docs[0])\n  // let regs = input.docs[0].map(t => {\n  //   return { id: t.id, optional: true }\n  // })\n  // m.after('(a|hoy)').debug()\n  // m.growRight('(a|hoy)').debug()\n  // console.log(m)\n  return m;\n};\nfns.replace = function (match, input, keep) {\n  if (match && !input) {\n    return this.replaceWith(match, keep);\n  }\n  let m = this.match(match);\n  if (!m.found) {\n    return this;\n  }\n  this.soften();\n  return m.replaceWith(input, keep);\n};\nexport default fns;","map":{"version":3,"names":["dollarStub","fns","titleCase","str","replace","txt","charAt","toUpperCase","substring","toLowerCase","replaceByFn","main","fn","forEach","m","out","replaceWith","subDollarSign","input","groups","a","num","hasOwnProperty","text","keep","ptrs","fullPointer","uncache","original","update","map","ptr","slice","oldTags","docs","term","Array","from","tags","fromText","compute","insertAfter","has","contractions","more","grow","expand","delete","toView","world","preTagger","terms","i","tagSafe","case","index","match","found","soften"],"sources":["/Users/godfredakpan/Documents/signature_generator/signature_generator/node_modules/compromise/src/1-one/change/api/replace.js"],"sourcesContent":["const dollarStub = /\\$[0-9a-z]+/g\nconst fns = {}\n\nconst titleCase = function (str) {\n  return str.replace(/\\w\\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substring(1).toLowerCase())\n}\n\n// doc.replace('foo', (m)=>{})\nconst replaceByFn = function (main, fn) {\n  main.forEach(m => {\n    let out = fn(m)\n    m.replaceWith(out)\n  })\n  return main\n}\n\n// support 'foo $0' replacements\nconst subDollarSign = function (input, main) {\n  if (typeof input !== 'string') {\n    return input\n  }\n  let groups = main.groups()\n  input = input.replace(dollarStub, (a) => {\n    let num = a.replace(/\\$/, '')\n    if (groups.hasOwnProperty(num)) {\n      return groups[num].text()\n    }\n    return a\n  })\n  return input\n}\n\nfns.replaceWith = function (input, keep = {}) {\n  let ptrs = this.fullPointer\n  let main = this\n  this.uncache()\n  if (typeof input === 'function') {\n    return replaceByFn(main, input)\n  }\n  // support 'foo $0' replacements\n  input = subDollarSign(input, main)\n\n  let original = this.update(ptrs)\n  // soften-up pointer\n  ptrs = ptrs.map(ptr => ptr.slice(0, 3))\n  // original.freeze()\n  let oldTags = (original.docs[0] || []).map(term => Array.from(term.tags))\n  // slide this in\n  if (typeof input === 'string') {\n    input = this.fromText(input).compute('id')\n  }\n  main.insertAfter(input)\n  // are we replacing part of a contraction?\n  if (original.has('@hasContraction') && main.contractions) {\n    let more = main.grow('@hasContraction+')\n    more.contractions().expand()\n  }\n  // delete the original terms\n  main.delete(original) //science.\n  // what should we return?\n  let m = main.toView(ptrs).compute(['index', 'lexicon'])\n  if (m.world.compute.preTagger) {\n    m.compute('preTagger')\n  }\n  // replace any old tags\n  if (keep.tags) {\n    m.terms().forEach((term, i) => {\n      term.tagSafe(oldTags[i])\n    })\n  }\n  // try to co-erce case, too\n  if (keep.case && m.docs[0] && m.docs[0][0] && m.docs[0][0].index[1] === 0) {\n    m.docs[0][0].text = titleCase(m.docs[0][0].text)\n  }\n  // console.log(input.docs[0])\n  // let regs = input.docs[0].map(t => {\n  //   return { id: t.id, optional: true }\n  // })\n  // m.after('(a|hoy)').debug()\n  // m.growRight('(a|hoy)').debug()\n  // console.log(m)\n  return m\n}\n\nfns.replace = function (match, input, keep) {\n  if (match && !input) {\n    return this.replaceWith(match, keep)\n  }\n  let m = this.match(match)\n  if (!m.found) {\n    return this\n  }\n  this.soften()\n  return m.replaceWith(input, keep)\n}\nexport default fns\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}